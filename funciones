def turn_float32_onehot(dataframe):
  """
  Turns all dtypes of a DF into float32, even one_hot
  """
  for column in dataframe.columns:
    if dataframe[column].dtype == "float64" or dataframe[column].dtype == "int64":
      dataframe[column] = dataframe[column].astype("float32")
    elif dataframe[column].dtype == "bool" or dataframe[column].dtype == "object":
      dummies = pd.get_dummies(tabla[column])
      dummies_float = dummies.astype("float32")
      dataframe = pd.concat([dataframe, dummies_float],axis=1) 
      dataframe = dataframe.drop(columns=column)
    else:
      continue
  
  return dataframe



def window(table,split_window_column, condition=True, window=10):
  """
  Given a table and a reference column, it will creat a new dataframe with a window (default=10) rows starting the True condition of the reference column 
  """
  table_1 = pd.DataFrame(columns=tabla.columns)
  for index, row in tabla.iterrows():
    if row[split_window_column] == condition:
      current_index = tabla.index.get_loc(index)
      tabla_2 = pd.concat([tabla_1, tabla.iloc[current_index:current_index+window]])
  return tabla_2
